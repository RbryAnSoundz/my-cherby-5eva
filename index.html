<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üíú My Cherby</title>
  <meta name="description" content="A romantic lilac-themed page with animated roses + hibiscus." />
  <style>
    :root{
      --bg1:#1b1024;
      --bg2:#2a1436;
      --lilac:#c9a6ff;
      --lilac2:#b48cff;
      --pink:#ffb7e7;
      --white:#fff7ff;
      --glass: rgba(255,255,255,.08);
      --glass2: rgba(255,255,255,.14);
      --shadow: 0 20px 60px rgba(0,0,0,.45);
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color: var(--white);
      overflow:auto;
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(201,166,255,.28), transparent 60%),
        radial-gradient(1000px 700px at 85% 25%, rgba(255,183,231,.20), transparent 55%),
        radial-gradient(900px 700px at 50% 90%, rgba(180,140,255,.22), transparent 60%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      scroll-behavior:smooth;
    }

    /* subtle twinkling particles */
    .sparkle-layer{
      position:fixed; inset:0;
      pointer-events:none;
      opacity:.55;
      filter: blur(.1px);
      z-index:0;
    }

    .wrap{
      position:relative;
      min-height:100vh;
      display:grid;
      place-items:center;
      padding: clamp(16px, 3vw, 36px);
      z-index:1;
    }

    .card{
      width:min(920px, 94vw);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 26px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      overflow:hidden;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(500px 220px at 30% 0%, rgba(201,166,255,.35), transparent 70%),
                  radial-gradient(420px 240px at 80% 10%, rgba(255,183,231,.28), transparent 70%);
      opacity:.85;
      pointer-events:none;
    }

    header{
      position:relative;
      padding: clamp(18px, 3vw, 34px);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 16px;
    }
    .title{
      display:flex; flex-direction:column; gap:10px;
      max-width: 640px;
    }
    .title h1{
      margin:0;
      font-size: clamp(22px, 3.2vw, 40px);
      letter-spacing: .2px;
      line-height:1.15;
    }
    .title p{
      margin:0;
      opacity:.90;
      font-size: clamp(14px, 1.6vw, 16px);
      line-height:1.45;
    }

    .badge{
      display:flex;
      align-items:center;
      gap:10px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 999px;
      padding: 10px 14px;
      font-size: 13px;
      white-space:nowrap;
      position:relative;
      margin-top: 2px;
    }
    .dot{
      width:10px; height:10px; border-radius:50%;
      background: var(--pink);
      box-shadow: 0 0 18px rgba(255,183,231,.9);
      animation: pulse 2.2s ease-in-out infinite;
    }
    @keyframes pulse{
      0%,100%{ transform:scale(1); opacity:1;}
      50%{ transform:scale(1.35); opacity:.65;}
    }

    .content{
      position:relative;
      display:grid;
      grid-template-columns: 1.08fr .92fr;
      gap: 18px;
      padding: 0 clamp(18px, 3vw, 34px) clamp(18px, 3vw, 34px);
    }
    @media (max-width: 860px){
      .content{ grid-template-columns:1fr; }
    }

    .panel{
      background: rgba(0,0,0,.14);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 20px;
      padding: 18px;
      position:relative;
      overflow:hidden;
    }

    .message{
      display:flex;
      flex-direction:column;
      gap: 14px;
      padding: 6px 2px;
    }
    .message .big{
      font-size: clamp(20px, 2.4vw, 28px);
      line-height:1.25;
      margin:0;
    }
    .message .small{
      margin:0;
      opacity:.92;
      font-size: 15px;
      line-height:1.62;
    }

    .jump-link{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      width: fit-content;
      color: var(--white);
      text-decoration:none;
      font-size: 13px;
      opacity:.95;
      transition: transform .12s ease, filter .12s ease;
    }
    .jump-link:hover{ transform: translateY(-1px); filter: brightness(1.06); }
    .jump-link .arrow{ opacity:.95; }

    .question{
      margin-top: 4px;
      display:flex;
      flex-wrap:wrap;
      gap: 10px;
      align-items:center;
    }
    button{
      appearance:none;
      border:none;
      cursor:pointer;
      border-radius: 999px;
      padding: 12px 16px;
      font-weight: 750;
      font-size: 14px;
      transition: transform .12s ease, filter .12s ease, box-shadow .2s ease;
      user-select:none;
    }
    .yes{
      background: linear-gradient(90deg, var(--lilac2), var(--pink));
      color:#1b1024;
      box-shadow: 0 10px 30px rgba(201,166,255,.25);
      position:relative;
    }
    .yes:hover{ transform: translateY(-1px); filter: brightness(1.05); }
    .yes.glow{
      box-shadow:
        0 10px 30px rgba(201,166,255,.26),
        0 0 0 1px rgba(255,255,255,.08),
        0 0 40px rgba(255,183,231,.35);
      animation: yesGlow 1.8s ease-in-out infinite;
    }
    @keyframes yesGlow{
      0%,100%{ filter: brightness(1.0); transform: translateY(0); }
      50%{ filter: brightness(1.08); transform: translateY(-1px); }
    }

    .no{
      background: rgba(255,255,255,.10);
      color: var(--white);
      border:1px solid rgba(255,255,255,.14);
    }
    .no:hover{ transform: translateY(-1px); filter: brightness(1.08); }

    .result{
      margin-top: 14px;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      padding: 12px 12px;
      min-height: 52px;
      display:flex;
      align-items:center;
      gap: 10px;
      opacity:0;
      transform: translateY(6px);
      transition: opacity .35s ease, transform .35s ease;
    }
    .result.show{
      opacity:1;
      transform: translateY(0);
    }
    .heart{
      width:22px; height:22px;
      filter: drop-shadow(0 0 14px rgba(255,183,231,.65));
    }

    /* Flower stage */
    .stage{
      position:relative;
      display:grid;
      gap: 12px;
      align-content:start;
    }
    .canvas-wrap{
      border-radius: 18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
      background: radial-gradient(1000px 500px at 30% 0%, rgba(201,166,255,.20), transparent 60%),
                  radial-gradient(800px 500px at 80% 25%, rgba(255,183,231,.16), transparent 55%),
                  rgba(0,0,0,.18);
      position:relative;
      min-height: 340px;
    }
    canvas#flowers{
      display:block;
      width:100%;
      height: 360px;
    }
    .caption{
      display:flex;
      justify-content:space-between;
      gap: 10px;
      align-items:center;
      font-size: 13px;
      opacity:.92;
    }
    .toggle{
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.14);
      color: var(--white);
      padding: 10px 12px;
      border-radius: 12px;
      font-size: 13px;
      cursor:pointer;
      transition: filter .12s ease, transform .12s ease;
    }
    .toggle:hover{ transform: translateY(-1px); filter: brightness(1.06); }

    .footer{
      position:relative;
      padding: 12px clamp(18px, 3vw, 34px) 18px;
      display:flex;
      justify-content:space-between;
      gap: 12px;
      opacity:.85;
      font-size: 12px;
    }
    .footer code{
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.12);
      padding: 3px 7px;
      border-radius: 8px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
    }

    /* FINAL QUESTION SCREEN */
    .final{
      position:relative;
      min-height: 100vh;
      display:grid;
      place-items:center;
      padding: clamp(18px, 3vw, 40px);
      z-index:1;
    }
    .final .box{
      width:min(820px, 94vw);
      border-radius: 28px;
      border: 1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      padding: clamp(18px, 3vw, 34px);
      position:relative;
      overflow:hidden;
      text-align:center;
    }
    .final .box::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(520px 260px at 50% 0%, rgba(201,166,255,.40), transparent 70%),
        radial-gradient(520px 260px at 50% 100%, rgba(255,183,231,.28), transparent 70%);
      opacity:.95;
      pointer-events:none;
    }
    .final h2{
      margin: 0 0 10px;
      font-size: clamp(26px, 4.2vw, 50px);
      line-height: 1.05;
      position:relative;
    }
    .final p{
      margin: 0 auto 18px;
      max-width: 58ch;
      opacity:.92;
      line-height:1.6;
      position:relative;
    }
    .final .buttons{
      display:flex;
      justify-content:center;
      gap: 12px;
      flex-wrap:wrap;
      position:relative;
    }
    .final .subnote{
      margin-top: 14px;
      font-size: 12px;
      opacity: .84;
      position:relative;
    }
  </style>
</head>
<body>
  <canvas class="sparkle-layer" id="sparkles"></canvas>

  <div class="wrap" id="top">
    <div class="card" role="application" aria-label="Romantic lilac proposal page">
      <header>
        <div class="title">
          <h1 id="headline">üíú My Cherby, I have something sweet to ask you‚Ä¶</h1>
          <p id="subhead">Lilac vibes, animated roses + hibiscus, and one honest question.</p>
        </div>
        <div class="badge" aria-label="Love meter">
          <span class="dot" aria-hidden="true"></span>
          <span id="badgeText">for my Cherby üíú</span>
        </div>
      </header>

      <div class="content">
        <!-- left: message -->
        <section class="panel">
          <div class="message">
            <p class="big" id="mainLine">My Cherby, I truly am so in love with you.</p>

            <p class="small" id="detailLine">
              I am who I am today because you came into my life. You showed me patience, kindness, and a kind of love that feels safe and real.
              Through you, I learned how to grow, how to listen, and how to become better‚Äînot just for myself, but for the people I care about.
              <br><br>
              Every day with you feels like a new chance to learn, to heal, and to love deeper. You inspire me without even trying, and you remind me
              that love isn‚Äôt just a feeling‚Äîit‚Äôs a choice, effort, and commitment. I want to keep choosing you. I want to keep loving you in the ways
              you love and deserve, supporting your dreams, protecting your heart, and growing together no matter what life brings us.
            </p>

            <!-- CLICKABLE LINK TO THE BIG QUESTION -->
            <a class="jump-link" id="jumpLink" href="#bigQuestion" aria-label="Jump to the big question">
              Tap to see the question <span class="arrow">‚Üí</span>
            </a>

            <div class="question">
              <button class="yes" id="yesBtn">Yes üíú</button>
              <button class="no" id="noBtn">Not yet üôà</button>
            </div>

            <div class="result" id="resultBox" aria-live="polite">
              <svg class="heart" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M12 21s-7.5-4.4-9.7-9.1C.6 8.6 2.2 5.6 5.4 5c1.9-.4 3.9.4 5 2.1 1.1-1.7 3.1-2.5 5-2.1 3.2.6 4.8 3.6 3.1 6.9C19.5 16.6 12 21 12 21Z"
                      fill="rgba(255,183,231,.95)"/>
              </svg>
              <div>
                <div id="resultTitle" style="font-weight:800; margin-bottom:2px;">Aww ü•π</div>
                <div id="resultText" style="opacity:.95;">I‚Äôm really happy. I‚Äôll treat you right.</div>
              </div>
            </div>
          </div>
        </section>

        <!-- right: flowers -->
        <section class="stage">
          <div class="canvas-wrap">
            <canvas id="flowers" width="900" height="360" aria-label="Animated roses and hibiscus"></canvas>
          </div>
          <div class="caption">
            <span id="captionText">Animated bouquet: <b>roses</b> + <b>hibiscus</b> (digital)</span>
            <button class="toggle" id="regenBtn" title="Refresh the bouquet">New bouquet ‚ú®</button>
          </div>
        </section>
      </div>

      <div class="footer">
        <div>Click the link to jump: <code>#bigQuestion</code></div>
        <div>Made with üíú</div>
      </div>
    </div>
  </div>

  <!-- FINAL BIG QUESTION SECTION -->
  <section class="final" id="bigQuestion" aria-label="Final question">
    <div class="box">
      <h2 id="finalTitle">My Cherby‚Ä¶ will you be my girlfriend? üíú</h2>
      <p id="finalText">
        Not just for today‚Äîbecause I want the kind of love that keeps growing. I want to choose you, support you,
        and build something real with you.
      </p>
      <div class="buttons">
        <button class="yes" id="finalYes">Yes üíú</button>
        <button class="no" id="finalNo">Not yet üôà</button>
      </div>
      <div class="subnote" id="finalNote">Tap ‚ÄúYes‚Äù and watch the hearts bloom ‚ú®</div>
    </div>
  </section>

  <script>
    /************* EDIT ME *************/
    const CONFIG = {
      theirName: "Cherby",
      headline: "üíú My Cherby, I have something sweet to ask you‚Ä¶",
      subhead: "Lilac vibes, animated roses + hibiscus, and one honest question.",
      mainLine: "My Cherby, I truly am so in love with you.",
      detailHTML: `
        I am who I am today because you came into my life. You showed me patience, kindness, and a kind of love that feels safe and real.
        Through you, I learned how to grow, how to listen, and how to become better‚Äînot just for myself, but for the people I care about.
        <br><br>
        Every day with you feels like a new chance to learn, to heal, and to love deeper. You inspire me without even trying, and you remind me
        that love isn‚Äôt just a feeling‚Äîit‚Äôs a choice, effort, and commitment. I want to keep choosing you. I want to keep loving you in the ways
        you love and deserve, supporting your dreams, protecting your heart, and growing together no matter what life brings us.
      `,
      yesResultTitle: "She said yes ü•πüíú",
      yesResultText: "You just made me the happiest person alive.",
      noResultTitle: "Take your time üíú",
      noResultText: "No pressure at all. I care about you deeply, always.",
      finalTitle: "My Cherby‚Ä¶ will you be my girlfriend? üíú",
      finalText: "Not just for today‚Äîbecause I want the kind of love that keeps growing. I want to choose you, support you, and build something real with you."
    };
    /**********************************/

    const byId = (id) => document.getElementById(id);

    function applyConfig(){
      byId("headline").textContent = CONFIG.headline;
      byId("subhead").textContent  = CONFIG.subhead;
      byId("mainLine").textContent = CONFIG.mainLine;
      byId("detailLine").innerHTML = CONFIG.detailHTML;

      byId("badgeText").textContent = `for my ${CONFIG.theirName} üíú`;
      byId("finalTitle").textContent = CONFIG.finalTitle;
      byId("finalText").textContent  = CONFIG.finalText;
      document.title = `üíú My ${CONFIG.theirName}`;
    }
    applyConfig();

    // Button glow after a few seconds
    const yesBtn = byId("yesBtn");
    const finalYes = byId("finalYes");
    setTimeout(() => {
      yesBtn.classList.add("glow");
      finalYes.classList.add("glow");
    }, 2400);

    // Result box
    const resultBox = byId("resultBox");
    const resultTitle = byId("resultTitle");
    const resultText  = byId("resultText");
    const noBtn  = byId("noBtn");
    const finalNo = byId("finalNo");

    function showResult(title, text){
      resultTitle.textContent = title;
      resultText.textContent  = text;
      resultBox.classList.add("show");
    }

    // Gentle playful "Not yet" behavior
    function playfulNo(btn){
      const maxShift = 24;
      const x = (Math.random()*2-1) * maxShift;
      const y = (Math.random()*2-1) * (maxShift * 0.6);
      btn.style.transform = `translate(${x}px, ${y}px)`;
      btn.style.filter = "brightness(1.08)";
      setTimeout(()=> {
        btn.style.transform = "";
        btn.style.filter = "";
      }, 520);
    }

    let noClicks = 0;
    noBtn.addEventListener("click", () => {
      noClicks++;
      showResult(CONFIG.noResultTitle, CONFIG.noResultText);
      playfulNo(noBtn);
      if (noClicks >= 3) noBtn.textContent = "Okay okay‚Ä¶ Yes? üòá";
    });

    finalNo.addEventListener("click", () => {
      showResult(CONFIG.noResultTitle, CONFIG.noResultText);
      playfulNo(finalNo);
      document.getElementById("top").scrollIntoView({behavior:"smooth", block:"start"});
    });

    // YES actions (both buttons)
    yesBtn.addEventListener("click", () => {
      showResult(CONFIG.yesResultTitle, CONFIG.yesResultText);
      burstHearts();
      // auto-scroll to the final question for the full moment
      byId("bigQuestion").scrollIntoView({behavior:"smooth", block:"center"});
    });

    finalYes.addEventListener("click", () => {
      showResult(CONFIG.yesResultTitle, CONFIG.yesResultText);
      burstHearts(true);
      burstHearts(true);
    });

    /**********************
     * FLOWER ANIMATION
     **********************/
    const canvas = byId("flowers");
    const ctx = canvas.getContext("2d");

    function resizeFlowerCanvas(){
      const rect = canvas.getBoundingClientRect();
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }

    window.addEventListener("resize", () => {
      resizeFlowerCanvas();
      seedBouquet();
    });

    let bouquet = [];
    function rand(min,max){ return min + Math.random()*(max-min); }

    function seedBouquet(){
      const w = canvas.getBoundingClientRect().width;
      const h = canvas.getBoundingClientRect().height;

      bouquet = [];
      const count = Math.round(Math.min(16, Math.max(10, w / 70)));
      for(let i=0;i<count;i++){
        const type = Math.random() < 0.55 ? "rose" : "hibiscus";
        bouquet.push({
          type,
          x: rand(50, w-50),
          y: rand(78, h-44),
          s: rand(0.78, 1.26),
          r: rand(-0.25, 0.25),
          sway: rand(0.8, 1.6),
          phase: rand(0, Math.PI*2),
          bloom: rand(0.62, 1.0),
          glow: rand(0.15, 0.35)
        });
      }
    }

    function drawPetal(cx, cy, rx, ry, rot){
      ctx.save();
      ctx.translate(cx, cy);
      ctx.rotate(rot);
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.bezierCurveTo(rx*0.7, -ry*0.2, rx*0.9, -ry*0.9, 0, -ry);
      ctx.bezierCurveTo(-rx*0.9, -ry*0.9, -rx*0.7, -ry*0.2, 0, 0);
      ctx.closePath();
      ctx.fill();
      ctx.restore();
    }

    function drawRose(f){
      const t = performance.now() * 0.001;
      const sway = Math.sin(t*f.sway + f.phase) * 0.06;

      ctx.save();
      ctx.translate(f.x, f.y);
      ctx.rotate(f.r + sway);

      ctx.globalAlpha = f.glow;
      ctx.beginPath();
      ctx.arc(0, 0, 42*f.s, 0, Math.PI*2);
      ctx.fillStyle = "rgba(201,166,255,0.6)";
      ctx.fill();

      ctx.globalAlpha = 0.95;
      const layers = 4;
      for(let L=0; L<layers; L++){
        const petals = 6 + L*2;
        const scale = (1 - L*0.16) * f.bloom;
        const baseR = 28 * f.s * scale;
        const baseY = 24 * f.s * scale;

        const a = 0.95 - L*0.10;
        const mix = L/(layers-1);
        ctx.fillStyle = `rgba(${Math.round(201 + 54*mix)}, ${Math.round(166 + 17*mix)}, ${Math.round(255 - 22*mix)}, ${a})`;

        for(let p=0;p<petals;p++){
          const rot = (p/petals) * Math.PI*2 + (t*0.15);
          drawPetal(0, 0, baseR*0.55, baseY, rot);
        }
      }

      ctx.globalAlpha = 0.9;
      ctx.beginPath();
      ctx.arc(0, 0, 10*f.s, 0, Math.PI*2);
      ctx.fillStyle = "rgba(255,183,231,.85)";
      ctx.fill();

      ctx.restore();
    }

    function drawHibiscus(f){
      const t = performance.now() * 0.001;
      const sway = Math.sin(t*f.sway + f.phase) * 0.07;

      ctx.save();
      ctx.translate(f.x, f.y);
      ctx.rotate(f.r + sway);

      ctx.globalAlpha = f.glow;
      ctx.beginPath();
      ctx.arc(0, 0, 44*f.s, 0, Math.PI*2);
      ctx.fillStyle = "rgba(255,183,231,0.55)";
      ctx.fill();

      ctx.globalAlpha = 0.92;
      const petals = 5;
      for(let p=0;p<petals;p++){
        const rot = (p/petals)*Math.PI*2 + (t*0.10);
        const rx = 34*f.s*f.bloom;
        const ry = 42*f.s*f.bloom;

        ctx.fillStyle = `rgba(255, 183, 231, ${0.58})`;
        drawPetal(0, 2*f.s, rx*0.55, ry, rot);

        ctx.fillStyle = `rgba(201, 166, 255, ${0.36})`;
        drawPetal(0, 2*f.s, rx*0.42, ry*0.78, rot);
      }

      ctx.globalAlpha = 0.95;
      ctx.strokeStyle = "rgba(255,247,255,.75)";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.lineTo(0, -34*f.s);
      ctx.stroke();

      ctx.fillStyle = "rgba(255,183,231,.95)";
      ctx.beginPath();
      ctx.arc(0, -34*f.s, 4.8*f.s, 0, Math.PI*2);
      ctx.fill();

      ctx.fillStyle = "rgba(180,140,255,.85)";
      ctx.beginPath();
      ctx.arc(0, 0, 9.5*f.s, 0, Math.PI*2);
      ctx.fill();

      ctx.restore();
    }

    function drawBackground(){
      const w = canvas.getBoundingClientRect().width;
      const h = canvas.getBoundingClientRect().height;
      const g = ctx.createRadialGradient(w*0.5, h*0.4, 40, w*0.5, h*0.45, Math.max(w,h)*0.8);
      g.addColorStop(0, "rgba(255,255,255,0.05)");
      g.addColorStop(1, "rgba(0,0,0,0.28)");
      ctx.fillStyle = g;
      ctx.fillRect(0,0,w,h);
    }

    // Floating "Cherby" text behind flowers
    function drawFloatingName(){
      const w = canvas.getBoundingClientRect().width;
      const h = canvas.getBoundingClientRect().height;
      const t = performance.now()*0.001;

      const name = CONFIG.theirName || "Cherby";
      const x = w*(0.52 + 0.06*Math.sin(t*0.22));
      const y = h*(0.40 + 0.07*Math.cos(t*0.18));

      ctx.save();
      ctx.globalAlpha = 0.16;
      ctx.translate(x, y);
      ctx.rotate(Math.sin(t*0.12)*0.08);

      ctx.font = `800 ${Math.max(34, Math.min(58, w*0.08))}px system-ui, -apple-system, Segoe UI, Roboto, Arial`;
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";

      // soft stroke + glow
      ctx.lineWidth = 3;
      ctx.strokeStyle = "rgba(255,247,255,.20)";
      ctx.shadowColor = "rgba(201,166,255,.45)";
      ctx.shadowBlur = 18;

      ctx.strokeText(name, 0, 0);
      ctx.fillStyle = "rgba(201,166,255,.28)";
      ctx.fillText(name, 0, 0);

      ctx.restore();
    }

    function frame(){
      const w = canvas.getBoundingClientRect().width;
      const h = canvas.getBoundingClientRect().height;
      ctx.clearRect(0,0,w,h);

      const t = performance.now()*0.001;
      const lx = w*(0.35 + 0.12*Math.sin(t*0.25));
      const ly = h*(0.25 + 0.10*Math.cos(t*0.22));
      const glow = ctx.createRadialGradient(lx, ly, 10, lx, ly, Math.max(w,h)*0.55);
      glow.addColorStop(0, "rgba(201,166,255,0.14)");
      glow.addColorStop(0.5, "rgba(255,183,231,0.08)");
      glow.addColorStop(1, "rgba(0,0,0,0)");
      ctx.fillStyle = glow;
      ctx.fillRect(0,0,w,h);

      drawFloatingName();

      for(const f of bouquet){
        if (f.type === "rose") drawRose(f);
        else drawHibiscus(f);
      }

      drawBackground();
      requestAnimationFrame(frame);
    }

    byId("regenBtn").addEventListener("click", () => {
      seedBouquet();
      burstHearts();
    });

    resizeFlowerCanvas();
    seedBouquet();
    frame();

    /**********************
     * SPARKLES + HEART BURSTS (fixed canvas)
     **********************/
    const sp = byId("sparkles");
    const spc = sp.getContext("2d");
    let stars = [];
    const heartParticles = [];

    function resizeSparkles(){
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      sp.width = Math.floor(window.innerWidth * dpr);
      sp.height = Math.floor(window.innerHeight * dpr);
      spc.setTransform(dpr,0,0,dpr,0,0);

      stars = [];
      const count = Math.round(Math.min(150, Math.max(80, window.innerWidth / 12)));
      for(let i=0;i<count;i++){
        stars.push({
          x: Math.random()*window.innerWidth,
          y: Math.random()*window.innerHeight,
          r: Math.random()*1.6 + 0.3,
          o: Math.random()*0.6 + 0.15,
          tw: Math.random()*1.6 + 0.6,
          ph: Math.random()*Math.PI*2
        });
      }
    }

    function burstHearts(extra){
      const originX = window.innerWidth * rand(0.40, 0.60);
      const originY = window.innerHeight * rand(0.30, 0.55);

      const amount = extra ? 26 : 18;
      for(let i=0;i<amount;i++){
        heartParticles.push({
          x: originX,
          y: originY,
          vx: rand(-1.8, 1.8),
          vy: rand(-3.4, -1.4),
          a: 1,
          s: rand(10, 16),
          rot: rand(0, Math.PI*2),
          vr: rand(-0.12, 0.12)
        });
      }
    }

    function drawHeartParticle(p){
      spc.save();
      spc.globalAlpha = p.a;
      spc.translate(p.x, p.y);
      spc.rotate(p.rot);
      spc.filter = "drop-shadow(0 0 14px rgba(255,183,231,.45))";
      spc.fillStyle = "rgba(255,183,231,.95)";

      spc.beginPath();
      spc.moveTo(0, 0);
      spc.bezierCurveTo(0, -10, -14, -10, -14, 0);
      spc.bezierCurveTo(-14, 10, 0, 16, 0, 22);
      spc.bezierCurveTo(0, 16, 14, 10, 14, 0);
      spc.bezierCurveTo(14, -10, 0, -10, 0, 0);
      spc.closePath();

      spc.scale(p.s/16, p.s/16);
      spc.fill();
      spc.restore();
    }

    function sparklesFrame(){
      spc.clearRect(0,0,window.innerWidth, window.innerHeight);
      const t = performance.now()*0.001;

      for(const s of stars){
        const o = s.o * (0.55 + 0.45*Math.sin(t*s.tw + s.ph));
        spc.globalAlpha = o;
        spc.beginPath();
        spc.arc(s.x, s.y, s.r, 0, Math.PI*2);
        spc.fillStyle = "rgba(255,247,255,1)";
        spc.fill();
      }

      for(let i=heartParticles.length-1; i>=0; i--){
        const p = heartParticles[i];
        p.vy += 0.05;
        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.vr;
        p.a *= 0.985;

        if (p.a < 0.05 || p.y > window.innerHeight + 40){
          heartParticles.splice(i,1);
          continue;
        }
        drawHeartParticle(p);
      }

      requestAnimationFrame(sparklesFrame);
    }

    window.addEventListener("resize", resizeSparkles);
    resizeSparkles();
    sparklesFrame();
  </script>
</body>
</html>
